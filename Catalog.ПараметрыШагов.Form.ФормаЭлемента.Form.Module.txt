

#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	УправлениеФормой();
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ТипПараметраПриИзменении(Элемент)
	УправлениеФормой();
КонецПроцедуры

&НаКлиенте
Процедура ЗначениеПараметраНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	ВыбранноеЗначение = ВыбратьФайлКаталог();
	Если НЕ ВыбранноеЗначение = Неопределено Тогда
		Объект.ЗначениеПараметра = ВыбранноеЗначение;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовТаблицыФормы_ИмяТаблицы



#КонецОбласти

#Область ОбработчикиКомандФормы



#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УправлениеФормой()
	Если Объект.ТипПараметра = Перечисления.ТипыПараметров.Файл или Объект.ТипПараметра = Перечисления.ТипыПараметров.Каталог Тогда
		Элементы.ЗначениеПараметра.КнопкаВыбора = Истина;
	Иначе
		Элементы.ЗначениеПараметра.КнопкаВыбора = Ложь;
	КонецЕсли;
КонецПроцедуры

Функция ВыбратьФайлКаталог()
	
	
	Если Объект.ТипПараметра = Перечисления.ТипыПараметров.Каталог Тогда
		РежимВыбораФайла = РежимДиалогаВыбораФайла.ВыборКаталога;
	Иначе
		РежимВыбораФайла = РежимДиалогаВыбораФайла.Сохранение;
	КонецЕсли;
	
	ДиалогФыбораФайла = Новый ДиалогВыбораФайла(РежимВыбораФайла);
	ДиалогФыбораФайла.Фильтр = "(*.*)|*.*"; 
	
	Если НЕ ДиалогФыбораФайла.Выбрать() Тогда
		Возврат Неопределено;
	ИначеЕсли РежимВыбораФайла = РежимДиалогаВыбораФайла.ВыборКаталога Тогда
		Возврат ДиалогФыбораФайла.Каталог;
	Иначе
		Возврат ДиалогФыбораФайла.ПолноеИмяФайла;
	КонецЕсли;	
	
КонецФункции


#КонецОбласти

