

Процедура ВыполнитьСценарий() Экспорт
	
	ОбновитьКонфигурациюИзХранилища(ПутьК1С, КаталогИБ, ПользовательИБ, ПарольИБ, КаталогХранилища, ПользовательХранилища, ПарольХранилища);
	
КонецПроцедуры

Процедура ОбновитьКонфигурациюИзХранилища(ПутьК1С, КаталогИБ, ПользовательИБ, ПарольИБ, КаталогХранилища, ПользовательХранилища, ПарольХранилища)
	
	Команда = "%ПутьК1С%   DESIGNER   %КаталогИБ% /N %ПользовательИБ% /P %ПарольИБ% "
		+" /ConfigurationRepositoryF %КаталогХранилища% /ConfigurationRepositoryN %ПользовательХранилища% /ConfigurationRepositoryP %ПарольХранилища% "
		+"/ConfigurationRepositoryUpdateCfg -force";
		
	Команда = СтрЗаменить(Команда, "%ПутьК1С%", ПутьК1С);
	
	Команда = СтрЗаменить(Команда, "%КаталогИБ%", КаталогИБ);
	Команда = СтрЗаменить(Команда, "%ПользовательИБ%", ПользовательИБ);
	Команда = СтрЗаменить(Команда, "%ПарольИБ%", ПарольИБ);
	
	Команда = СтрЗаменить(Команда, "%КаталогХранилища%", КаталогХранилища);
	Команда = СтрЗаменить(Команда, "%ПользовательХранилища%", ПользовательХранилища);
	Команда = СтрЗаменить(Команда, "%ПарольХранилища%", ПарольХранилища);
		
	
	ПакетныйРежим.ВыполнитьИзКоманднойСтроки(Команда);

КонецПроцедуры
